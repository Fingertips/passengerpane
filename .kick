recipe :ignore
ignore(/^(tmp|Passenger.xcodeproj)/)

recipe :ruby

module Nu
  def self.run_tests(files)
    unless files.empty?
      execute "rake test:passenger_pane"
    end
  end
end

process do |files|
  Ruby.run_tests(files.take_and_map do |file|
    case file
    when %r{^test/ppane/test_helper/add_allow_switch.rb$}
      'test/ppane/test_helper/add_allow_switch_test.rb'
    end
  end)
  
  Nu.run_tests(files.take_and_map do |file|
    case file
    when %r{^app/.*\.m$}, %r{^test/passenger_pane/.*_test\.nu$}
      file
    end
  end)
end